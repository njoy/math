#include "math/implementation/IteratorTaylorSeries.hpp"

namespace math {
namespace implementation {

/**
 * @brief Evaluated via Horner's rule
 * @result The value of the Taylor series at @p x
 */
template< typename iterator >
inline double
IteratorTaylorSeries<iterator>::eval(const double x) const {
  double accumulator;
  accumulator = 0;
  for (std::reverse_iterator<iterator>
         it(this->coefficientsEnd),
         P0(this->coefficientsBegin + 1); it != P0; ++it){
    accumulator = (accumulator + (*it)) * x;
  }
  accumulator += *(this->coefficientsBegin);
  return accumulator;
}

} // implementation
} // math
